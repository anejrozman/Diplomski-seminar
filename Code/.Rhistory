}
g6
set.seed(42)
# PARAMETERS
lambda = 1 # Intensity of HPP
a = 1/3.1415926535 # Parameters for normal distribution
T = 1000 # Time horizon of simulation
N = 10 # Number of simulations of CPP
# Simulate arrival times
arrivalTimes = c(0)
t = 0
while (t <= T) {
interarrivalTime = rexp(1, rate = lambda)
t = t + interarrivalTime
arrivalTimes = c(arrivalTimes, t)
}
# Simulate CPP
sim = data.frame(arrivalTimes)
sim$EX = (3.1415926535)*lambda*sim$arrivalTimes
sim$VarX = lambda*arrivalTimes*(3.1415926535^2 + 3.1415926535^4)
simulations = c()
for (i in 1:N){
sim[glue("X{i}")] = rexp(length(arrivalTimes), a)
sim[glue("CPP{i}")] = cumsum(sim[glue("X{i}")])
simulations = c(simulations, glue("CPP{i}"))
}
colors = c("cyan", "red", "blueviolet", "darkorange",
"cyan4", "red4", "darkorchid4", "darkorange3",
"aquamarine", "brown1","cornflowerblue",  "darkgoldenrod1" )
g6 = ggplot() +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.7,
color = "red") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX + 3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6
# save graph to pdf
ggsave(glue("{FILEPATH}slika6.pdf"),
g6,
device = "pdf",
width = 8,
height = 5)
set.seed(42)
set.seed(42)
# PARAMETERS
lambda = 1 # Intensity of HPP
a = 1/3.1415926535 # Parameters for normal distribution
T = 1000 # Time horizon of simulation
N = 10 # Number of simulations of CPP
# Simulate arrival times
arrivalTimes = c(0)
t = 0
while (t <= T) {
interarrivalTime = rexp(1, rate = lambda)
t = t + interarrivalTime
arrivalTimes = c(arrivalTimes, t)
}
# Simulate CPP
sim = data.frame(arrivalTimes)
sim$EX = (3.1415926535)*lambda*sim$arrivalTimes
sim$VarX = lambda*arrivalTimes*(3.1415926535^2 + 3.1415926535^4)
simulations = c()
for (i in 1:N){
sim[glue("X{i}")] = rexp(length(arrivalTimes), a)
sim[glue("CPP{i}")] = cumsum(sim[glue("X{i}")])
simulations = c(simulations, glue("CPP{i}"))
}
colors = c("cyan", "red", "blueviolet", "darkorange",
"cyan4", "red4", "darkorchid4", "darkorange3",
"aquamarine", "brown1","cornflowerblue",  "darkgoldenrod1" )
g6 = ggplot() +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.7,
color = "red") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6
g6 = ggplot() +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.7,
color = "red") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6
# save graph to pdf
ggsave(glue("{FILEPATH}slika6.pdf"),
g6,
device = "pdf",
width = 8,
height = 5)
set.seed(42)
# PARAMETERS
lambda = 1 # Intensity of HPP
mu = 2
sigma = 8# Parameters for normal distribution
T = 1000 # Time horizon of simulation
N = 10 # Number of simulations of CPP
# Simulate arrival times
arrivalTimes = c(0)
t = 0
while (t <= T) {
interarrivalTime = rexp(1, rate = lambda)
t = t + interarrivalTime
arrivalTimes = c(arrivalTimes, t)
}
# Simulate CPP
sim = data.frame(arrivalTimes)
sim$EX = mu*lambda*sim$arrivalTimes
sim$VarX = lambda*arrivalTimes*(mu^2 + sigma^2)
simulations = c()
for (i in 1:N){
sim[glue("X{i}")] = rnrom(length(arrivalTimes), mu, sigma)
sim[glue("CPP{i}")] = cumsum(sim[glue("X{i}")])
simulations = c(simulations, glue("CPP{i}"))
}
# Simulate arrival times
arrivalTimes = c(0)
t = 0
while (t <= T) {
interarrivalTime = rexp(1, rate = lambda)
t = t + interarrivalTime
arrivalTimes = c(arrivalTimes, t)
}
# Simulate CPP
sim = data.frame(arrivalTimes)
sim$EX = mu*lambda*sim$arrivalTimes
sim$VarX = lambda*arrivalTimes*(mu^2 + sigma^2)
simulations = c()
for (i in 1:N){
sim[glue("X{i}")] = rnorm(length(arrivalTimes), mu, sigma)
sim[glue("CPP{i}")] = cumsum(sim[glue("X{i}")])
simulations = c(simulations, glue("CPP{i}"))
}
colors = c("cyan", "red", "blueviolet", "darkorange",
"cyan4", "red4", "darkorchid4", "darkorange3",
"aquamarine", "brown1","cornflowerblue",  "darkgoldenrod1" )
g6 = ggplot() +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.7,
color = "red") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6
set.seed(42)
# PARAMETERS
lambda = 1 # Intensity of HPP
mu = 2
sigma = 42# Parameters for normal distribution
T = 1000 # Time horizon of simulation
N = 10 # Number of simulations of CPP
# Simulate arrival times
arrivalTimes = c(0)
t = 0
while (t <= T) {
interarrivalTime = rexp(1, rate = lambda)
t = t + interarrivalTime
arrivalTimes = c(arrivalTimes, t)
}
# Simulate CPP
sim = data.frame(arrivalTimes)
sim$EX = mu*lambda*sim$arrivalTimes
sim$VarX = lambda*arrivalTimes*(mu^2 + sigma^2)
simulations = c()
for (i in 1:N){
sim[glue("X{i}")] = rnorm(length(arrivalTimes), mu, sigma)
sim[glue("CPP{i}")] = cumsum(sim[glue("X{i}")])
simulations = c(simulations, glue("CPP{i}"))
}
colors = c("cyan", "red", "blueviolet", "darkorange",
"cyan4", "red4", "darkorchid4", "darkorange3",
"aquamarine", "brown1","cornflowerblue",  "darkgoldenrod1" )
g6 = ggplot() +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.7,
color = "red") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6
colors = c("cyan", "red", "blueviolet", "darkorange",
"cyan4", "red4", "darkorchid4", "darkorange3",
"aquamarine", "brown1","cornflowerblue",  "darkgoldenrod1" )
g6 = ggplot()
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 2,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
g6
g6 = ggplot()
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 1.1,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
g6
g6 = ggplot()
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 1,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
g6
# save graph to pdf
ggsave(glue("{FILEPATH}slika6.pdf"),
g6,
device = "pdf",
width = 8,
height = 5)
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.8,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = glue(" \u03BB={lambda}, a={a}"),
x = "Čas",
y = "Vrednost CPP")
g6
# save graph to pdf
ggsave(glue("{FILEPATH}slika6.pdf"),
g6,
device = "pdf",
width = 8,
height = 5)
set.seed(42)
# PARAMETERS
lambda = 1 # Intensity of HPP
mu = 2
sigma = 42# Parameters for normal distribution
T = 1000 # Time horizon of simulation
N = 10 # Number of simulations of CPP
# Simulate arrival times
arrivalTimes = c(0)
t = 0
while (t <= T) {
interarrivalTime = rexp(1, rate = lambda)
t = t + interarrivalTime
arrivalTimes = c(arrivalTimes, t)
}
# Simulate CPP
sim = data.frame(arrivalTimes)
sim$EX = mu*lambda*sim$arrivalTimes
sim$VarX = lambda*arrivalTimes*(mu^2 + sigma^2)
simulations = c()
for (i in 1:N){
sim[glue("X{i}")] = rnorm(length(arrivalTimes), mu, sigma)
sim[glue("CPP{i}")] = cumsum(sim[glue("X{i}")])
simulations = c(simulations, glue("CPP{i}"))
}
colors = c("cyan", "red", "blueviolet", "darkorange",
"cyan4", "red4", "darkorchid4", "darkorange3",
"aquamarine", "brown1","cornflowerblue",  "darkgoldenrod1" )
g6 = ggplot()
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.8,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = expression(lambda == 1 ~mu == 2 ~ sigma == 42 ~ Število~simulacij~ == 10),
g6
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.8,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = expression(lambda == 1 ~mu == 2 ~ sigma == 42 ~ Število~simulacij~ == 10),
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.8,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = expression(lambda == 1 ~mu == 2~sigma == 42 ~ Število~simulacij~10),
x = "Čas",
y = "Vrednost CPP")
g6
g6 = ggplot()
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.8,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = expression(lambda == 1 ~mu == 2~sigma == 42),
x = "Čas",
y = "Vrednost CPP")
g6
# save graph to pdf
ggsave(glue("{FILEPATH}slika6.pdf"),
g6,
device = cairo_pdf,
width = 8,
height = 5)
g6 = ggplot()
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.8,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = expression(lambda == 1 ~mu == 2~sigma == 42),
x = "Čas (t)",
y = "Vrednost (S_t)")
g6
# save graph to pdf
ggsave(glue("{FILEPATH}slika6.pdf"),
g6,
device = cairo_pdf,
width = 8,
height = 5)
g6 = ggplot()
for (i in 1:N){
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = !!sym(as.character(simulations[i]))),
color = colors[i])
}
g6 = g6 + geom_line(data = sim,
aes(x = arrivalTimes, y = EX),
size = 0.8,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX +3*sqrt(VarX)),
size = 0.7,
color = "black") +
geom_line(data = sim,
aes(x = arrivalTimes, y = EX - 3*sqrt(VarX)),
size = 0.7,
color = "black") +
labs(title = expression(lambda == 1 ~mu == 2~sigma == 42),
x = "Čas (t)",
y = TeX(r'(Vrednost $(S_t)$ )'))
g6
g6
# save graph to pdf
ggsave(glue("{FILEPATH}slika6.pdf"),
g6,
device = cairo_pdf,
width = 8,
height = 5)
